Все дефекты, что мы получаем всегда создаются как дефекты в таблице issues_issue
У Руководителей рембригады есть меню массового назначения, в котором он может выбрать несколько дефектов и назначить их на кого-то.
При массовом назначении, если есть дефекты с одним placement, то эти дефекты объединяются в один дефект, в этом дефекте создаются услуги по 1 на каждый дефект. В услуги записывается соответствующий roomer_id

таблица услуг - issues_issueservice

код сервиса https://gitlab.samoletgroup.ru/10d/construction/scontrol/-/blob/main/app/warranties/services/warranties_bulk.py#L43

Верхняя часть картинки про схлопывание:
![[Pasted image 20230522105638.png]]